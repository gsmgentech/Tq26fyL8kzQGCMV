const hamburger=document.querySelector(".hamburger"),navLinks=document.querySelector(".nav-links"),navOverlay=document.querySelector(".nav-overlay"),navItems=document.querySelectorAll(".nav-links a"),logo=document.querySelector(".logo");function closeMenu(){navLinks.classList.remove("active"),hamburger.classList.remove("active"),navOverlay.classList.remove("active")}async function searchRecord(e){e.preventDefault();let t=document.getElementById("recordNumber").value.trim(),n=document.getElementById("message");if(n.textContent="",n.classList.remove("show"),t){let r="service-record/"+encodeURIComponent(t)+".html";try{let a=await fetch(r,{method:"HEAD"});a.ok?window.location.href=r:showMessage("⚠️ No service record found.")}catch(c){showMessage("⚠️ No service record found.")}}}function showMessage(e){let t=document.getElementById("message");t.textContent=e,t.classList.add("show"),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>{t.textContent=""},800)},3e3)}hamburger.addEventListener("click",()=>{navLinks.classList.toggle("active"),hamburger.classList.toggle("active"),navOverlay.classList.toggle("active")}),navOverlay.addEventListener("click",()=>{closeMenu()}),navItems.forEach(e=>{e.addEventListener("click",()=>{closeMenu()})});const animatedElements=document.querySelectorAll("[data-animate]"),observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animated"),"fade-up"===e.target.dataset.animate?e.target.style.animation="fadeUp 1s forwards":"zoom-in"===e.target.dataset.animate&&(e.target.style.animation="zoomIn 1s forwards"),observer.unobserve(e.target))})},{threshold:.2});animatedElements.forEach(e=>observer.observe(e));let clickCount=0,clickTimer;const clickWindowMs=3e3,requiredClicks=5,redirectUrl="UuLxeqUTlswEXfHIWpvxSoljzDQnpnkwntEJjddRnkOXLYUulN";function registerLogoClick(){clickCount+=1,clearTimeout(clickTimer),clickTimer=setTimeout(()=>{clickCount=0},3e3),clickCount>=5&&(clickCount=0,window.location.href="UuLxeqUTlswEXfHIWpvxSoljzDQnpnkwntEJjddRnkOXLYUulN")}logo&&(logo.addEventListener("click",registerLogoClick),logo.addEventListener("touchstart",registerLogoClick));const openScannerBtn=document.getElementById("openScanner"),closeScannerBtn=document.getElementById("closeScanner"),scanSection=document.getElementById("scan-qr"),qrResult=document.getElementById("qr-result");let html5QrCode,scannerRunning=!1;function showScanSection(e){scanSection.setAttribute("aria-hidden",e?"false":"true"),scanSection.style.display=e?"block":"none"}function onScanSuccess(e){if(qrResult.textContent="Scanned: "+e,e.startsWith("http://")||e.startsWith("https://")){window.location.href=e,stopScanner();return}let t="service-record/"+encodeURIComponent(e)+".html";fetch(t,{method:"HEAD"}).then(n=>{n.ok?(stopScanner(),window.location.href=t):qrResult.textContent="No matching service record found for: "+e}).catch(()=>{qrResult.textContent="No matching service record found for: "+e})}function onScanFailure(e){}function startScanner(){if(!scannerRunning){if(!window.Html5Qrcode){qrResult.textContent="QR library not loaded.";return}(html5QrCode=new Html5Qrcode("reader")).start({facingMode:"environment"},{fps:10,qrbox:{width:280,height:280}},onScanSuccess,onScanFailure).then(()=>{scannerRunning=!0,qrResult.textContent="Scanning... point camera at QR code."}).catch(e=>{qrResult.textContent="Camera error: "+e})}}function stopScanner(){scannerRunning&&html5QrCode&&html5QrCode.stop().then(()=>{html5QrCode.clear(),scannerRunning=!1,qrResult.textContent=""}).catch(()=>{scannerRunning=!1})}openScannerBtn.addEventListener("click",()=>{showScanSection(!0),startScanner()}),closeScannerBtn.addEventListener("click",()=>{stopScanner(),showScanSection(!1)}),document.addEventListener("visibilitychange",()=>{document.hidden&&stopScanner()});